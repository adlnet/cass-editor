(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-530eb192"],{"3ba8":function(t,e,s){"use strict";var o=s("a89b"),i=s.n(o);i.a},a89b:function(t,e,s){},e672:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"framework-editor-toolbar"}},[s("div",{staticClass:"fet__wrapper"},[s("div",{staticClass:"left-side"},[s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.closeViewDropDown,expression:"closeViewDropDown"}],staticClass:"dropdown",class:{"is-active":t.showPropertyViewDropDown}},[s("div",{staticClass:"dropdown-trigger"},[s("button",{staticClass:"button is-small is-text",attrs:{"aria-haspopup":"true"},on:{click:function(e){t.showPropertyViewDropDown=!t.showPropertyViewDropDown}}},[s("span",[t._v("View")]),t._m(0)])]),s("div",{staticClass:"dropdown-menu",attrs:{id:"property-dropdown",role:"menu"}},[s("div",{staticClass:"dropdown-content"},[s("a",{staticClass:"dropdown-item",on:{click:function(e){return t.changeProperties("primary")}}},[s("span",{staticClass:"icon",class:"primary"===t.activeView?"":"is-hidden"},[s("i",{staticClass:"fa fa-check has-text-primary"})]),t._v(" Primary Properties ")]),s("a",{staticClass:"dropdown-item",on:{click:function(e){return t.changeProperties("secondary")}}},[s("span",{staticClass:"icon",class:"secondary"===t.activeView?"":"is-hidden"},[s("i",{staticClass:"fa fa-check has-text-link"})]),t._v(" Secondary Properties ")]),s("a",{staticClass:"dropdown-item",on:{click:function(e){return t.changeProperties("tertiary")}}},[s("span",{staticClass:"icon",class:"tertiary"===t.activeView?"":"is-hidden"},[s("i",{staticClass:"fa fa-check"})]),t._v(" Tertiary Properties ")])])])]),s("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.closeShareDropDown,expression:"closeShareDropDown"}],staticClass:"dropdown",class:{"is-active":t.showShareDropdown}},[s("div",{staticClass:"dropdown-trigger"},[s("button",{staticClass:"button is-small is-text",attrs:{"aria-haspopup":"true"},on:{click:function(e){t.showShareDropdown=!t.showShareDropdown}}},[s("span",[t._v("Framework")]),t._m(1)])]),s("div",{staticClass:"dropdown-menu",attrs:{id:"share-menu",role:"menu"}},[s("div",{staticClass:"dropdown-content"},[s("a",{staticClass:"dropdown-item",class:{"is-disabled":!t.canExport},on:{click:function(e){return t.handleExportClick()}}},[t._v(" Export ")]),t.loggedIn?s("a",{staticClass:"dropdown-item",on:{click:function(e){t.showManageUsersModal(),t.showShareDropdown=!1}}},[t._v(" Manage Users ")]):s("a",{staticClass:"dropdown-item",on:{click:function(e){t.showManageUsersModal(),t.showShareDropdown=!1}}},[t._v(" Get Shareable Link ")])])])]),t.showAddComments?s("div",{staticClass:"button is-text is-small has-text-primary",on:{click:t.handleClickAddComment}},[t._m(2)]):t._e(),t.showViewComments?s("div",{staticClass:"button is-text is-small has-text-dark",on:{click:function(e){return t.$store.commit("app/showRightAside","Comments")}}},[t._m(3)]):t._e(),t.canEditFramework?s("div",{staticClass:"button is-small is-text has-text-dark",on:{click:t.onClickUndo}},[t._m(4)]):t._e(),t.canEditFramework?s("div",{staticClass:"button is-text is-small",on:{click:function(e){return t.$store.commit("app/showRightAside","Versions")}}},[t._m(5)]):t._e(),s("div",{staticClass:"button is-small is-text has-text-primary",on:{click:t.copyClick}},[t._m(6)]),s("div",{staticClass:"button is-small is-text has-text-primary",on:{click:t.cutClick}},[t._m(7)]),s("div",{staticClass:"button is-small is-text has-text-primary",attrs:{title:"paste"},on:{click:t.pasteClick}},[t._m(8)])]),t.configurationsEnabled?s("div",{staticClass:"right-side"},[t.canEditFramework&&!t.conceptMode?s("div",{staticClass:"button is-small is-text is-pulled-right",on:{click:function(e){t.showManageConfigurationModal(),t.showShareDropdown=!1}}},[t._m(9),s("span",[t._v(t._s(t.defaultFrameworkConfigName))])]):t._e()]):t._e()])])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-angle-down has-text-link",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-angle-down has-text-link",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-comment-medical"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-comments"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-undo-alt "})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-history has-text-dark"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon "},[s("i",{staticClass:"fa fa-copy is-size-7"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas handle fa-cut"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-paste is-size-7"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-cog has-text-dark"})])}],r=(s("c975"),s("b0c0"),s("ac1f"),s("5319"),s("2ca0"),s("6d79")),a={name:"EditorToolbar",mixins:[r["a"]],props:{selectedArray:Array},data:function(){return{showPropertyViewDropDown:!1,showShareDropdown:!1,activeView:"primary",repo:window.repo,editsFinishedCounter:0,totalEditsCounter:0,defaultFrameworkConfigName:null}},methods:{closeViewDropDown:function(){this.showPropertyViewDropDown&&(this.showPropertyViewDropDown=!1)},closeShareDropDown:function(){this.showShareDropdown&&(this.showShareDropdown=!1)},handleExportClick:function(){this.canExport&&(this.$emit("showExportModal"),this.showShareDropdown=!1)},handleClickAddComment:function(){this.$store.commit("editor/setAddCommentAboutId",this.$store.getters["editor/framework"].shortId()),this.$store.commit("editor/setAddCommentType","new"),this.$store.commit("app/showModal",{component:"AddComment"})},showExportModal:function(){this.$store.commit("app/showModal","Export")},showManageUsersModal:function(){this.$store.commit("app/showModal",{component:"Share"})},showManageConfigurationModal:function(){this.$store.commit("app/showModal",{component:"Configuration"})},changeProperties:function(t){this.$emit("changeProperties",t),this.showPropertyViewDropDown=!1,this.activeView=t},onClickUndo:function(){var t=this;this.$Progress.start(),this.$store.dispatch("editor/lastEditToUndo").then((function(e){if(e){EcArray.isArray(e)||(e=[e]),t.totalEditsCounter+=e.length;for(var s=0;s<e.length;s++){var o=e[s].operation;"addNew"===o?t.undoAdd(e[s].id):"delete"===o?t.undoDelete(e[s].obj):"update"===o&&t.undoUpdate(e[s])}}t.$store.commit("editor/setLastEditToUndo",null)}))},undoAdd:function(t){var e=this;this.repo.deleteRegistered(EcRepository.getBlocking(t),(function(){e.editsFinishedCounter++}),(function(t){appLog(t),e.editsFinishedCounter++,e.$Progress.fail()}))},undoDelete:function(t){var e=t,s=this;"Concept"===t.type&&(e=new EcConcept,e.copyFrom(t)),this.repo.saveTo(e,(function(){s.editsFinishedCounter++,s.$Progress.finish()}),(function(t){appLog(t),s.editsFinishedCounter++,s.$Progress.fail()}))},undoUpdate:function(t){var e=this;EcRepository.get(t.id,(function(s){if(t.expandedProperty)return e.undoUpdateWithExpandedProperty(t,s);for(var o=0;o<t.fieldChanged.length;o++)s[t.fieldChanged[o]]=t.initialValue[o];e.repo.saveTo(s,(function(){e.editsFinishedCounter++,e.$Progress.finish()}),(function(){e.editsFinishedCounter++,e.$Progress.fail()})),e.$store.commit("editor/changedObject",s.shortId())}),(function(t){appError(t),e.editsFinishedCounter++,e.$Progress.fail()}))},undoUpdateWithExpandedProperty:function(t,e){var s=this;this.expand(e,(function(e){for(var o=0;o<t.fieldChanged.length;o++)e[t.fieldChanged[o]]=t.initialValue[o],0===e[t.fieldChanged[o]].length&&delete e[t.fieldChanged[o]],s.saveExpanded(e)}))},expand:function(t,e){var s=JSON.parse(t.toJson());null!=s["@context"]&&s["@context"].startsWith("http://")&&(s["@context"]=s["@context"].replace("http://","https://")),null!=s["@context"]&&-1!==s["@context"].indexOf("skos")&&(s["@context"]="https://schema.cassproject.org/0.4/skos/"),jsonld.expand(s,(function(t,s){e(null==t?s[0]:null)}))},saveExpanded:function(t){var e=this,s="https://schema.cassproject.org/0.4";-1!==t["@type"][0].toLowerCase().indexOf("concept")&&(s="https://schema.cassproject.org/0.4/skos"),jsonld.compact(t,this.$store.state.lode.rawSchemata[s],(function(t,o){if(null!=t&&appError(t),o){var i=new EcRemoteLinkedData;i.copyFrom(o),i.context=s,delete i["@context"],i=e.turnFieldsBackIntoArrays(i),i["schema:dateModified"]=(new Date).toISOString(),e.$store.state.editor&&!0===e.$store.state.editor.private&&!0!==EcEncryptedValue.encryptOnSaveMap[i.id]&&(i=EcEncryptedValue.toEncryptedValue(i)),e.repo.saveTo(i,(function(){e.editsFinishedCounter++}),(function(t){appError(t),e.editsFinishedCounter++}))}}))},turnFieldsBackIntoArrays:function(t){for(var e=["owner","reader","signature","competency","level","relation","skos:hasTopConcept","skos:narrower","skos:broader","skos:broadMatch","skos:closeMatch","skos:exactMatch","skos:narrowMatch","skos:related"],s=0;s<e.length;s++){var o=e[s];t[o]&&!EcArray.isArray(t[o])&&(t[o]=[t[o]])}return t},getConfigurationName:function(){if(this.$store.getters["editor/framework"].configuration){var t=EcRepository.getBlocking(this.$store.getters["editor/framework"].configuration);this.defaultFrameworkConfigName=t?t.name:"No configuration"}else this.defaultFrameworkConfigName="No configuration"},cutClick:function(){this.selectedArray&&1===this.selectedArray.length&&this.$store.commit("editor/cutId",this.selectedArray[0]),this.$store.commit("editor/copyId",null),this.$store.commit("editor/paste",!1)},copyClick:function(){this.selectedArray&&1===this.selectedArray.length&&this.$store.commit("editor/copyId",this.selectedArray[0]),this.$store.commit("editor/cutId",null),this.$store.commit("editor/paste",!1)},pasteClick:function(){this.$store.commit("editor/paste",!0)}},computed:{showAddComments:function(){return!0!==this.$store.getters["editor/conceptMode"]&&this.$store.state.app.canAddComments},showViewComments:function(){return!0!==this.$store.getters["editor/conceptMode"]&&this.$store.state.app.canViewComments},framework:function(){return this.$store.state.editor.framework},queryParams:function(){return this.$store.getters["editor/queryParams"]},canEditFramework:function(){return(!this.queryParams||"true"!==this.queryParams.view)&&!!this.framework.canEditAny(EcIdentityManager.getMyPks())},loggedIn:function(){return!!(EcIdentityManager.ids&&EcIdentityManager.ids.length>0)},configuration:function(){return this.$store.getters["editor/framework"].configuration},conceptMode:function(){return this.$store.getters["editor/conceptMode"]},canExport:function(){return!this.$store.state.editor.private&&!(this.framework.reader&&this.framework.reader.length>0)},configurationsEnabled:function(){return this.$store.state.featuresEnabled.configurationsEnabled}},watch:{editsFinishedCounter:function(){if(this.editsFinishedCounter&&this.editsFinishedCounter===this.totalEditsCounter){this.editsFinishedCounter=0,this.totalEditsCounter=0;var t=this.$store.getters["editor/framework"];this.$store.commit("editor/framework",EcRepository.getBlocking(t.shortId())),this.$store.commit("editor/recomputeHierarchy",!0),this.$store.commit("editor/refreshAlignments",!0)}},configuration:function(){this.getConfigurationName()}},mounted:function(){this.getConfigurationName()}},n=a,c=(s("3ba8"),s("2877")),d=Object(c["a"])(n,o,i,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-530eb192.890b0c98.js.map