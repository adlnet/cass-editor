(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-530eb192"],{"3ba8":function(t,e,s){"use strict";var i=s("a89b"),o=s.n(i);o.a},a89b:function(t,e,s){},e672:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"framework-editor-toolbar"}},[s("div",{staticClass:"fet__wrapper"},[s("div",{staticClass:"left-side"},[s("div",{staticClass:"dropdown",class:{"is-active":t.showPropertyViewDropDown}},[s("div",{staticClass:"dropdown-trigger"},[s("button",{staticClass:"button is-small is-text",attrs:{"aria-haspopup":"true"},on:{click:function(e){t.showPropertyViewDropDown=!t.showPropertyViewDropDown}}},[s("span",[t._v("View")]),t._m(0)])]),s("div",{staticClass:"dropdown-menu",attrs:{id:"property-dropdown",role:"menu"}},[s("div",{staticClass:"dropdown-content"},[s("a",{staticClass:"dropdown-item",on:{click:function(e){return t.changeProperties("primary")}}},[s("span",{staticClass:"icon",class:"primary"===t.activeView?"":"is-hidden"},[s("i",{staticClass:"fa fa-check has-text-primary"})]),t._v(" Primary Properties ")]),s("a",{staticClass:"dropdown-item",on:{click:function(e){return t.changeProperties("secondary")}}},[s("span",{staticClass:"icon",class:"secondary"===t.activeView?"":"is-hidden"},[s("i",{staticClass:"fa fa-check has-text-link"})]),t._v(" Secondary Properties ")]),s("a",{staticClass:"dropdown-item",on:{click:function(e){return t.changeProperties("tertiary")}}},[s("span",{staticClass:"icon",class:"tertiary"===t.activeView?"":"is-hidden"},[s("i",{staticClass:"fa fa-check"})]),t._v(" Tertiary Properties ")])])])]),s("div",{staticClass:"dropdown",class:{"is-active":t.showShareDropdown}},[s("div",{staticClass:"dropdown-trigger"},[s("button",{staticClass:"button is-small is-text",attrs:{"aria-haspopup":"true"},on:{click:function(e){t.showShareDropdown=!t.showShareDropdown}}},[s("span",[t._v("Framework")]),t._m(1)])]),s("div",{staticClass:"dropdown-menu",attrs:{id:"share-menu",role:"menu"}},[s("div",{staticClass:"dropdown-content"},[s("a",{staticClass:"dropdown-item",class:{"is-disabled":!t.canExport},on:{click:function(e){return t.handleExportClick()}}},[t._v(" Export ")]),t.loggedIn?s("a",{staticClass:"dropdown-item",on:{click:function(e){t.showManageUsersModal(),t.showShareDropdown=!1}}},[t._v(" Manage Users ")]):s("a",{staticClass:"dropdown-item",on:{click:function(e){t.showManageUsersModal(),t.showShareDropdown=!1}}},[t._v(" Get Shareable Link ")])])])]),t.showAddComments?s("div",{staticClass:"button is-text has-text-primary",on:{click:t.handleClickAddComment}},[t._m(2)]):t._e(),t.showViewComments?s("div",{staticClass:"button is-text is-small has-text-dark",on:{click:function(e){return t.$store.commit("app/showRightAside","Comments")}}},[t._m(3)]):t._e(),t.canEditFramework?s("div",{staticClass:"button is-small is-text has-text-dark",on:{click:t.onClickUndo}},[t._m(4)]):t._e(),t.canEditFramework?s("div",{staticClass:"button is-text is-small",on:{click:function(e){return t.$store.commit("app/showRightAside","Versions")}}},[t._m(5)]):t._e(),s("div",{staticClass:"button is-small is-text has-text-primary",on:{click:t.copyClick}},[t._m(6)]),s("div",{staticClass:"button is-small is-text has-text-primary",on:{click:t.cutClick}},[t._m(7)]),s("div",{staticClass:"button is-small is-text has-text-primary",attrs:{title:"paste"},on:{click:t.pasteClick}},[t._m(8)])]),s("div",{staticClass:"right-side"},[t.canEditFramework&&!t.conceptMode?s("div",{staticClass:"button is-small is-text is-pulled-right",on:{click:function(e){t.showManageConfigurationModal(),t.showShareDropdown=!1}}},[t._m(9),s("span",[t._v(t._s(t.defaultFrameworkConfigName))])]):t._e()])])])},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-angle-down has-text-link",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fas fa-angle-down has-text-link",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-comment-medical"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-comments"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-undo-alt "})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-history has-text-dark"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon "},[s("i",{staticClass:"fa fa-copy is-size-7"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas handle fa-cut"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-paste is-size-7"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fas fa-cog has-text-dark"})])}],n=(s("c975"),s("b0c0"),s("ac1f"),s("5319"),s("2ca0"),s("96cf"),s("1da1")),a=s("6d79"),r={name:"EditorToolbar",mixins:[a["a"]],props:{selectedArray:Array},data:function(){return{showPropertyViewDropDown:!1,showShareDropdown:!1,activeView:"primary",repo:window.repo,editsFinishedCounter:0,totalEditsCounter:0,defaultFrameworkConfigName:null}},methods:{handleExportClick:function(){this.canExport&&(this.$emit("showExportModal"),this.showShareDropdown=!1)},handleClickAddComment:function(){this.$store.commit("editor/setAddCommentAboutId",this.$store.getters["editor/framework"].shortId()),this.$store.commit("editor/setAddCommentType","new"),this.$store.commit("app/showModal",{component:"AddComment"})},showExportModal:function(){this.$store.commit("app/showModal","Export")},showManageUsersModal:function(){this.$store.commit("app/showModal",{component:"Share"})},showManageConfigurationModal:function(){this.$store.commit("app/showModal",{component:"Configuration"})},changeProperties:function(t){this.$emit("changeProperties",t),this.showPropertyViewDropDown=!1,this.activeView=t},onClickUndo:function(){var t=this;this.$store.dispatch("editor/lastEditToUndo").then((function(e){if(e){EcArray.isArray(e)||(e=[e]),t.totalEditsCounter+=e.length;for(var s=0;s<e.length;s++){var i=e[s].operation;"addNew"===i?t.undoAdd(e[s].id):"delete"===i?t.undoDelete(e[s].obj):"update"===i&&t.undoUpdate(e[s])}}t.$store.commit("editor/setLastEditToUndo",null)}))},undoAdd:function(t){var e=this;this.repo.deleteRegistered(EcRepository.getBlocking(t),(function(){e.editsFinishedCounter++}),(function(t){console.log(t),e.editsFinishedCounter++}))},undoDelete:function(t){var e=t,s=this;"Concept"===t.type&&(e=new EcConcept,e.copyFrom(t)),this.repo.saveTo(e,(function(){s.editsFinishedCounter++}),(function(t){console.log(t),s.editsFinishedCounter++}))},undoUpdate:function(t){var e=this;EcRepository.get(t.id,(function(s){if(t.expandedProperty)return e.undoUpdateWithExpandedProperty(t,s);for(var i=0;i<t.fieldChanged.length;i++)s[t.fieldChanged[i]]=t.initialValue[i];e.repo.saveTo(s,(function(){e.editsFinishedCounter++}),(function(){e.editsFinishedCounter++})),e.$store.commit("editor/changedObject",s.shortId())}),(function(t){console.error(t),e.editsFinishedCounter++}))},undoUpdateWithExpandedProperty:function(t,e){var s=this;this.expand(e,(function(e){for(var i=0;i<t.fieldChanged.length;i++)e[t.fieldChanged[i]]=t.initialValue[i],0===e[t.fieldChanged[i]].length&&delete e[t.fieldChanged[i]],s.saveExpanded(e)}))},expand:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e,s){var i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=JSON.parse(e.toJson()),null!=i["@context"]&&i["@context"].startsWith("http://")&&(i["@context"]=i["@context"].replace("http://","https://")),null!=i["@context"]&&-1!==i["@context"].indexOf("skos")&&(i["@context"]="https://schema.cassproject.org/0.4/skos/"),t.next=5,jsonld.expand(i);case 5:o=t.sent,o&&o[0]?s(o[0]):s(null);case 7:case"end":return t.stop()}}),t)})));function e(e,s){return t.apply(this,arguments)}return e}(),saveExpanded:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s,i,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=this,i="https://schema.cassproject.org/0.4",-1!==e["@type"][0].toLowerCase().indexOf("concept")&&(i="https://schema.cassproject.org/0.4/skos"),t.next=5,jsonld.compact(e,this.$store.state.lode.rawSchemata[i]);case 5:o=t.sent,o&&(n=new EcRemoteLinkedData,n.copyFrom(o),n.context=i,delete n["@context"],n=s.turnFieldsBackIntoArrays(n),n["schema:dateModified"]=(new Date).toISOString(),s.$store.state.editor&&!0===s.$store.state.editor.private&&!0!==EcEncryptedValue.encryptOnSaveMap[n.id]&&(n=EcEncryptedValue.toEncryptedValue(n)),s.repo.saveTo(n,(function(){s.editsFinishedCounter++}),(function(t){console.error(t),s.editsFinishedCounter++})));case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),turnFieldsBackIntoArrays:function(t){for(var e=["owner","reader","signature","competency","level","relation","skos:hasTopConcept","skos:narrower","skos:broader","skos:broadMatch","skos:closeMatch","skos:exactMatch","skos:narrowMatch","skos:related"],s=0;s<e.length;s++){var i=e[s];t[i]&&!EcArray.isArray(t[i])&&(t[i]=[t[i]])}return t},getConfigurationName:function(){if(this.$store.getters["editor/framework"].configuration){var t=EcRepository.getBlocking(this.$store.getters["editor/framework"].configuration);this.defaultFrameworkConfigName=t?t.name:"No configuration"}else this.defaultFrameworkConfigName="No configuration"},cutClick:function(){this.selectedArray&&1===this.selectedArray.length&&this.$store.commit("editor/cutId",this.selectedArray[0]),this.$store.commit("editor/copyId",null),this.$store.commit("editor/paste",!1)},copyClick:function(){this.selectedArray&&1===this.selectedArray.length&&this.$store.commit("editor/copyId",this.selectedArray[0]),this.$store.commit("editor/cutId",null),this.$store.commit("editor/paste",!1)},pasteClick:function(){this.$store.commit("editor/paste",!0)}},computed:{showAddComments:function(){return!0!==this.$store.getters["editor/conceptMode"]&&this.$store.state.app.canAddComments},showViewComments:function(){return!0!==this.$store.getters["editor/conceptMode"]&&this.$store.state.app.canViewComments},framework:function(){return this.$store.state.editor.framework},queryParams:function(){return this.$store.getters["editor/queryParams"]},canEditFramework:function(){return(!this.queryParams||"true"!==this.queryParams.view)&&!!this.framework.canEditAny(EcIdentityManager.getMyPks())},loggedIn:function(){return!!(EcIdentityManager.ids&&EcIdentityManager.ids.length>0)},configuration:function(){return this.$store.getters["editor/framework"].configuration},conceptMode:function(){return this.$store.getters["editor/conceptMode"]},canExport:function(){return!this.$store.state.editor.private&&!(this.framework.reader&&this.framework.reader.length>0)}},watch:{editsFinishedCounter:function(){if(this.editsFinishedCounter&&this.editsFinishedCounter===this.totalEditsCounter){this.editsFinishedCounter=0,this.totalEditsCounter=0;var t=this.$store.getters["editor/framework"];this.$store.commit("editor/framework",EcRepository.getBlocking(t.shortId())),this.$store.commit("editor/recomputeHierarchy",!0)}},configuration:function(){this.getConfigurationName()}},mounted:function(){this.getConfigurationName()}},c=r,d=(s("3ba8"),s("2877")),l=Object(d["a"])(c,i,o,!1,null,null,null);e["default"]=l.exports}}]);
//# sourceMappingURL=chunk-530eb192.52af8235.js.map