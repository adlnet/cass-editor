(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-43ecacca"],{"3ba8":function(t,e,o){"use strict";var s=o("b742"),n=o.n(s);n.a},b742:function(t,e,o){},e672:function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"framework-editor-toolbar"}},[o("div",{staticClass:"fet__wrapper"},[o("div",{staticClass:"left-side"},[o("div",{staticClass:"dropdown",class:{"is-active":t.showPropertyViewDropDown}},[o("div",{staticClass:"dropdown-trigger"},[o("button",{staticClass:"button is-text",attrs:{"aria-haspopup":"true"},on:{click:function(e){t.showPropertyViewDropDown=!t.showPropertyViewDropDown}}},[o("span",[t._v("View")]),t._m(0)])]),o("div",{staticClass:"dropdown-menu",attrs:{id:"property-dropdown",role:"menu"}},[o("div",{staticClass:"dropdown-content"},[o("a",{staticClass:"dropdown-item",on:{click:function(e){return t.changeProperties("primary")}}},[o("span",{staticClass:"icon",class:"primary"===t.activeView?"":"is-hidden"},[o("i",{staticClass:"fa fa-check has-text-primary"})]),t._v("\n                            Primary Properties\n                        ")]),o("a",{staticClass:"dropdown-item",on:{click:function(e){return t.changeProperties("secondary")}}},[o("span",{staticClass:"icon",class:"secondary"===t.activeView?"":"is-hidden"},[o("i",{staticClass:"fa fa-check has-text-link"})]),t._v("\n                            Secondary Properties\n                        ")]),o("a",{staticClass:"dropdown-item",on:{click:function(e){return t.changeProperties("tertiary")}}},[o("span",{staticClass:"icon",class:"tertiary"===t.activeView?"":"is-hidden"},[o("i",{staticClass:"fa fa-check"})]),t._v("\n                            Tertiary Properties\n                        ")])])])]),o("div",{staticClass:"dropdown",class:{"is-active":t.showShareDropdown}},[o("div",{staticClass:"dropdown-trigger"},[o("button",{staticClass:"button is-text",attrs:{"aria-haspopup":"true"},on:{click:function(e){t.showShareDropdown=!t.showShareDropdown}}},[o("span",[t._v("Framework")]),t._m(1)])]),o("div",{staticClass:"dropdown-menu",attrs:{id:"share-menu",role:"menu"}},[o("div",{staticClass:"dropdown-content"},[o("a",{staticClass:"dropdown-item",on:{click:function(e){t.$emit("showExportModal"),t.showShareDropdown=!1}}},[t._v("\n                            Export\n                        ")]),t.loggedIn?o("a",{staticClass:"dropdown-item",on:{click:function(e){t.showManageUsersModal(),t.showShareDropdown=!1}}},[t._v("\n                            Manage Users\n                        ")]):o("a",{staticClass:"dropdown-item",on:{click:function(e){t.showManageUsersModal(),t.showShareDropdown=!1}}},[t._v("\n                            Get Shareable Link\n                        ")])])])]),t.showAddComments?o("div",{staticClass:"button is-text has-text-primary",on:{click:t.handleClickAddComment}},[t._m(2)]):t._e(),t.showViewComments?o("div",{staticClass:"button is-text has-text-dark",on:{click:function(e){return t.$store.commit("app/showRightAside","Comments")}}},[t._m(3)]):t._e(),t.canEditFramework?o("div",{staticClass:"button is-text has-text-dark",on:{click:t.onClickUndo}},[t._m(4)]):t._e(),t.canEditFramework?o("div",{staticClass:"button is-text",on:{click:function(e){return t.$store.commit("app/showRightAside","Versions")}}},[t._m(5)]):t._e()]),o("div",{staticClass:"right-side"},[t.canEditFramework&&!t.conceptMode?o("div",{staticClass:"button is-text is-pulled-right",on:{click:function(e){t.showManageConfigurationModal(),t.showShareDropdown=!1}}},[t._m(6),o("span",[t._v(t._s(t.defaultFrameworkConfigName))])]):t._e()])])])},n=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"icon is-small"},[o("i",{staticClass:"fas fa-angle-down has-text-link",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"icon is-small"},[o("i",{staticClass:"fas fa-angle-down has-text-link",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"icon"},[o("i",{staticClass:"fas fa-comment-medical"})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"icon"},[o("i",{staticClass:"fas fa-comments"})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"icon"},[o("i",{staticClass:"fas fa-undo-alt "})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"icon"},[o("i",{staticClass:"fas fa-history has-text-dark"})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("span",{staticClass:"icon"},[o("i",{staticClass:"fas fa-cog has-text-dark"})])}],i=(o("7f7f"),o("a481"),o("f559"),o("6d79")),a={name:"EditorToolbar",mixins:[i["a"]],data:function(){return{showPropertyViewDropDown:!1,showShareDropdown:!1,activeView:"primary",repo:window.repo,editsFinishedCounter:0,totalEditsCounter:0,defaultFrameworkConfigName:null}},methods:{handleClickAddComment:function(){this.$store.commit("editor/setAddCommentAboutId",this.$store.getters["editor/framework"].shortId()),this.$store.commit("editor/setAddCommentType","new"),this.$store.commit("app/showModal",{component:"AddComment"})},showExportModal:function(){this.$store.commit("app/showModal","Export")},showManageUsersModal:function(){this.$store.commit("app/showModal",{component:"Share"})},showManageConfigurationModal:function(){this.$store.commit("app/showModal",{component:"Configuration"})},changeProperties:function(t){this.$emit("changeProperties",t),this.showPropertyViewDropDown=!1,this.activeView=t},onClickUndo:function(){var t=this;this.$store.dispatch("editor/lastEditToUndo").then((function(e){if(e){EcArray.isArray(e)||(e=[e]),t.totalEditsCounter+=e.length;for(var o=0;o<e.length;o++){var s=e[o].operation;"addNew"===s?t.undoAdd(e[o].id):"delete"===s?t.undoDelete(e[o].obj):"update"===s&&t.undoUpdate(e[o])}}t.$store.commit("editor/setLastEditToUndo",null)}))},undoAdd:function(t){var e=this;this.repo.deleteRegistered(EcRepository.getBlocking(t),(function(){e.editsFinishedCounter++}),(function(t){console.log(t),e.editsFinishedCounter++}))},undoDelete:function(t){var e=t,o=this;"Concept"===t.type&&(e=new EcConcept,e.copyFrom(t)),this.repo.saveTo(e,(function(){o.editsFinishedCounter++}),(function(t){console.log(t),o.editsFinishedCounter++}))},undoUpdate:function(t){var e=this;EcRepository.get(t.id,(function(o){if(t.expandedProperty)return e.undoUpdateWithExpandedProperty(t,o);for(var s=0;s<t.fieldChanged.length;s++)o[t.fieldChanged[s]]=t.initialValue[s];e.repo.saveTo(o,(function(){e.editsFinishedCounter++}),(function(){e.editsFinishedCounter++})),e.$store.commit("editor/changedObject",o.shortId())}),(function(t){console.error(t),e.editsFinishedCounter++}))},undoUpdateWithExpandedProperty:function(t,e){var o=this;this.expand(e,(function(e){for(var s=0;s<t.fieldChanged.length;s++)e[t.fieldChanged[s]]=t.initialValue[s],0===e[t.fieldChanged[s]].length&&delete e[t.fieldChanged[s]],o.saveExpanded(e)}))},expand:function(t,e){var o=JSON.parse(t.toJson());null!=o["@context"]&&o["@context"].startsWith("http://")&&(o["@context"]=o["@context"].replace("http://","https://")),null!=o["@context"]&&-1!==o["@context"].indexOf("skos")&&(o["@context"]="https://schema.cassproject.org/0.4/skos/"),jsonld.expand(o,(function(t,o){e(null==t?o[0]:null)}))},saveExpanded:function(t){var e=this,o="https://schema.cassproject.org/0.4";-1!==t["@type"][0].toLowerCase().indexOf("concept")&&(o="https://schema.cassproject.org/0.4/skos"),jsonld.compact(t,this.$store.state.lode.rawSchemata[o],(function(t,s){null!=t&&console.error(t);var n=new EcRemoteLinkedData;n.copyFrom(s),n.context=o,delete n["@context"],n=e.turnFieldsBackIntoArrays(n),n["schema:dateModified"]=(new Date).toISOString(),e.$store.state.editor&&!0===e.$store.state.editor.private&&!0!==EcEncryptedValue.encryptOnSaveMap[n.id]&&(n=EcEncryptedValue.toEncryptedValue(n)),e.repo.saveTo(n,(function(){e.editsFinishedCounter++}),(function(t){console.error(t),e.editsFinishedCounter++}))}))},turnFieldsBackIntoArrays:function(t){for(var e=["owner","reader","signature","competency","level","relation","skos:hasTopConcept","skos:narrower","skos:broader","skos:broadMatch","skos:closeMatch","skos:exactMatch","skos:narrowMatch","skos:related"],o=0;o<e.length;o++){var s=e[o];t[s]&&!EcArray.isArray(t[s])&&(t[s]=[t[s]])}return t},getConfigurationName:function(){if(this.$store.getters["editor/framework"].configuration){var t=EcRepository.getBlocking(this.$store.getters["editor/framework"].configuration);this.defaultFrameworkConfigName=t?t.name:"No configuration"}else this.defaultFrameworkConfigName="No configuration"}},computed:{showAddComments:function(){return!0!==this.$store.getters["editor/conceptMode"]&&this.$store.state.app.canAddComments},showViewComments:function(){return!0!==this.$store.getters["editor/conceptMode"]&&this.$store.state.app.canViewComments},framework:function(){return this.$store.state.editor.framework},queryParams:function(){return this.$store.getters["editor/queryParams"]},canEditFramework:function(){return(!this.queryParams||"true"!==this.queryParams.view)&&!!this.framework.canEditAny(EcIdentityManager.getMyPks())},loggedIn:function(){return!!(EcIdentityManager.ids&&EcIdentityManager.ids.length>0)},configuration:function(){return this.$store.getters["editor/framework"].configuration},conceptMode:function(){return this.$store.getters["editor/conceptMode"]}},watch:{editsFinishedCounter:function(){if(this.editsFinishedCounter&&this.editsFinishedCounter===this.totalEditsCounter){this.editsFinishedCounter=0,this.totalEditsCounter=0;var t=this.$store.getters["editor/framework"];this.$store.commit("editor/framework",EcRepository.getBlocking(t.shortId())),this.$store.commit("editor/recomputeHierarchy",!0)}},configuration:function(){this.getConfigurationName()}},mounted:function(){this.getConfigurationName()}},r=a,c=(o("3ba8"),o("2877")),d=Object(c["a"])(r,s,n,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-43ecacca.bd2fdf79.js.map